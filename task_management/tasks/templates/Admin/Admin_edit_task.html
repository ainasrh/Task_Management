{% extends 'Admin/admin_base.html' %}
{% block title %}Edit Task{% endblock %}

{% block content %}
<h2>Edit Task</h2>

{% if error %}
    <div class="alert alert-danger">{{ error }}</div>
{% endif %}

<form method="post">
    {% csrf_token %}
    <div class="mb-3">
        <label class="form-label">Title</label>
        <input type="text" name="title" class="form-control" value="{{ task.title }}" required>
    </div>

    <div class="mb-3">
        <label class="form-label">Description</label>
        <textarea name="description" class="form-control" required>{{ task.description }}</textarea>
    </div>

    <div class="mb-3">
        <label class="form-label">Assigned To</label>
        <select name="assigned_to" class="form-select" required>
            {% for user in assigned_users %}
                <option value="{{ user.id }}" {% if user.id == task.assigned_to.id %}selected{% endif %}>
                    {{ user.username }}
                </option>
            {% endfor %}
        </select>
    </div>

    <div class="mb-3">
        <label class="form-label">Due Date</label>
        <input type="date" name="due_date" class="form-control" value="{{ task.due_date|date:'Y-m-d' }}" required>
    </div>

    <div class="mb-3">
        <label class="form-label">Status</label>
        <select name="status" class="form-select" required>
            <option value="pending" {% if task.status == 'pending' %}selected{% endif %}>Pending</option>
            <option value="in_progress" {% if task.status == 'in_progress' %}selected{% endif %}>In Progress</option>
            <option value="completed" {% if task.status == 'completed' %}selected{% endif %}>Completed</option>
        </select>
    </div>

    <div class="mb-3">
        <label class="form-label">Completion Report</label>
        <textarea name="completion_report" class="form-control">{{ task.completion_report }}</textarea>
    </div>

    <div class="mb-3">
        <label class="form-label">Worked Hours</label>
        <input type="number" name="worked_hours" class="form-control" step="0.1" min="0" value="{{ task.worked_hours }}">
    </div>

    <button type="submit" class="btn btn-success">Save Changes</button>
    <a href="{% url 'admin_dashboard' %}" class="btn btn-secondary">Cancel</a>
</form>
{% endblock %}
